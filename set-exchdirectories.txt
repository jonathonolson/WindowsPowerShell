$url = "mail.domain.com"
if ( (Get-PSSnapin -Name Microsoft.Exchange.Management.PowerShell.Admin -ErrorAction SilentlyContinue) -eq $null )
{
    Add-PsSnapin Microsoft.Exchange.Management.PowerShell.Admin
}
Set-AutodiscoverVirtualDirectory -Identity "BB-SBS08\Autodiscover (SBS Web Applications)" -ExternalUrl:https://$url/Autodiscover/Autodiscover.xml -verbose
Set-AutodiscoverVirtualDirectory -Identity "BB-SBS08\Autodiscover (SBS Web Applications)" -InternalUrl:https://$url/Autodiscover/Autodiscover.xml -verbose

Set-WebServicesVirtualDirectory -Identity "EWS (SBS Web Applications)" -InternalUrl:https://$url/EWS/Exchange.asmx -verbose
Set-WebServicesVirtualDirectory -Identity "EWS (SBS Web Applications)" -ExternalUrl:https://$url/EWS/Exchange.asmx -verbose

Set-WebServicesVirtualDirectory -Identity "EWS (SBS Web Applications)" -InternalUrl:https://$url/EWS/Exchange.asmx -verbose
Set-WebServicesVirtualDirectory -Identity "EWS (SBS Web Applications)" -ExternalUrl:https://$url/EWS/Exchange.asmx -verbose

Set-UmVirtualDirectory -Identity "UnifiedMessaging (SBS Web Applications)" -InternalUrl:https://$url/UnifiedMessaging/Service.asmx -verbose
Set-UmVirtualDirectory -Identity "UnifiedMessaging (SBS Web Applications)" -ExternalUrl:https://$url/UnifiedMessaging/Service.asmx -verbose

Set-OabVirtualDirectory -Identity "BB-SBS08\OAB (SBS Web Applications)" -ExternalUrl:https://$url/OAB -verbose
Set-OabVirtualDirectory -Identity "BB-SBS08\OAB (SBS Web Applications)" -InternalUrl:https://$url/OAB -verbose

Set-OutlookAnywhere -Identity "BB-SBS08\Rpc (SBS Web Applications)" -ExternalHostname $url -verbose

Set-ActiveSyncVirtualDirectory -Identity "BB-SBS08\Microsoft-Server-ActiveSync (SBS Web Applications)" -externalurl "https://$url/Microsoft-Server-ActiveSync" -internalurl "https://$url/Microsoft-Server-ActiveSync" -verbose

Set-ClientAccessServer -Identity BB-SBS08 -AutoDiscoverServiceInternalUri "https://$url/Autodiscover/Autodiscover.xml" -verbose
