<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>Get Disk Drive Function</title>        
        <meta name="description" content="This is an advanced powershell function that returns size, free space, percent free space, page file status, and other information about a disk drive. " />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-0ff576f5848cc94fc137b836dc754265-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<h2>Description</h2>
<p><span style="font-size:small">The Get-DiskDrive function is an advanced function to be used in Windows PowerShell. You need to load the function first, or include it inside an additional script. Use Get-Help Get-DiskDrive to find basic information about
 the function. Use Get-Help Get-DiskDrive -full to see complete help information. Use Get-Help Get-DiskDrive -example to see only examples of using the function. This function is discussed on the
<a href="http://blogs.technet.com/b/heyscriptingguy/">Hey Scripting Guy! blog </a>
article from June 26, 2011. </span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Function Get-DiskDrive
{
  &lt;#
   .Synopsis
    This function returns capacity and freespace in gigs, and percent free
   .Description
    This function returns capacity and freespace in gigs, and percent free. By 
    default it returns the system drive (normally drive c:)
   .Example
    Get-DiskDrive
    Returns capacity and free space in gigabytes. It also returns percent free,
    and the drive letter and drive label of the system drive on the local machine.
   .Example
    Get-DiskDrive -drive e: -computer berlin
    Returns capacity and free space in gigabytes of the e: drive. It also returns
    percent free, and the drive letter and drive label of the system drive on the 
    remote machine named berlin.
   .Example
    Get-DiskDrive -drive e: -computer berlin, munich
    Returns capacity and free space in gigabytes of the e: drive. It also returns
    percent free, and the drive letter and drive label of the system drive on two 
    remote machines named berlin and munich.
   .Example
    Get-DiskDrive -drive c:, e: -computer berlin, munich
    Returns capacity and free space in gigabytes of the C: and e: drive. It also 
    returns percent free, and the drive letter and drive label of the system drive 
    on two remote machines named berlin and munich.
   .Example
    &quot;c:&quot;,&quot;d:&quot;,&quot;f:&quot; | % { Get-DiskDrive $_ }
    Returns information about c, d, and f drives on local computer. 
   .Example
    Get-DiskDrive -d &quot;c:&quot;,&quot;d:&quot;,&quot;f:&quot;
    Returns information about c, d, and f drives on local computer. Same command
    as the previous example - but easier to read. But on my computer this is a 
    bit slower than the previous command (40 milliseconds).
   .Parameter drive
    The drive letter to query.  Defaults to system drive (normally c:)
   .Parameter computername
    The name of the computer to query. Defaults to local machine. 
   .Notes
    NAME:  Example-
    AUTHOR: ed wilson, msft
    LASTEDIT: 06/02/2011 16:12:08
    KEYWORDS:
    HSG: HSG-06-26-2011
   .Link
    Http://www.ScriptingGuys.com/blog
 #Requires -Version 2.0
 #&gt;
 Param(
  [string[]]$drive = $env:SystemDrive,
  [string[]]$computername = $env:COMPUTERNAME
 ) #end param
 Foreach($d in $drive)
 {
  Get-WmiObject -Class win32_Volume -ComputerName $computername -Filter &quot;DriveLetter = '$d'&quot; |
  Select-object DriveLetter, Label, FileSystem, PageFilePresent, 
  @{Name = &quot;ComputerName&quot;; Expression = {$_.__Server} },
  @{Name = &quot;Capacity(GB)&quot;; Expression = {$_.capacity / 1GB} }, 
  @{Name = &quot;FreeSpace(GB)&quot;; Expression = {$_.Freespace / 1GB} },
  @{Name = &quot;PercentFree&quot;; Expression = { ($_.FreeSpace / $_.Capacity)*100 } }
 } # end foreach
 
} #end function get-diskdrive</pre>
<div class="preview">
<pre class="powershell"><span class="powerShell__keyword">Function</span>&nbsp;Get<span class="powerShell__operator">-</span>DiskDrive&nbsp;
{&nbsp;
&nbsp;&nbsp;<span class="powerShell__mlcom">&lt;#&nbsp;
&nbsp;&nbsp;&nbsp;.Synopsis&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;function&nbsp;returns&nbsp;capacity&nbsp;and&nbsp;freespace&nbsp;in&nbsp;gigs,&nbsp;and&nbsp;percent&nbsp;free&nbsp;
&nbsp;&nbsp;&nbsp;.Description&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;function&nbsp;returns&nbsp;capacity&nbsp;and&nbsp;freespace&nbsp;in&nbsp;gigs,&nbsp;and&nbsp;percent&nbsp;free.&nbsp;By&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;it&nbsp;returns&nbsp;the&nbsp;system&nbsp;drive&nbsp;(normally&nbsp;drive&nbsp;c:)&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Get-DiskDrive&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;capacity&nbsp;and&nbsp;free&nbsp;space&nbsp;in&nbsp;gigabytes.&nbsp;It&nbsp;also&nbsp;returns&nbsp;percent&nbsp;free,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;drive&nbsp;letter&nbsp;and&nbsp;drive&nbsp;label&nbsp;of&nbsp;the&nbsp;system&nbsp;drive&nbsp;on&nbsp;the&nbsp;local&nbsp;machine.&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Get-DiskDrive&nbsp;-drive&nbsp;e:&nbsp;-computer&nbsp;berlin&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;capacity&nbsp;and&nbsp;free&nbsp;space&nbsp;in&nbsp;gigabytes&nbsp;of&nbsp;the&nbsp;e:&nbsp;drive.&nbsp;It&nbsp;also&nbsp;returns&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;percent&nbsp;free,&nbsp;and&nbsp;the&nbsp;drive&nbsp;letter&nbsp;and&nbsp;drive&nbsp;label&nbsp;of&nbsp;the&nbsp;system&nbsp;drive&nbsp;on&nbsp;the&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;remote&nbsp;machine&nbsp;named&nbsp;berlin.&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Get-DiskDrive&nbsp;-drive&nbsp;e:&nbsp;-computer&nbsp;berlin,&nbsp;munich&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;capacity&nbsp;and&nbsp;free&nbsp;space&nbsp;in&nbsp;gigabytes&nbsp;of&nbsp;the&nbsp;e:&nbsp;drive.&nbsp;It&nbsp;also&nbsp;returns&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;percent&nbsp;free,&nbsp;and&nbsp;the&nbsp;drive&nbsp;letter&nbsp;and&nbsp;drive&nbsp;label&nbsp;of&nbsp;the&nbsp;system&nbsp;drive&nbsp;on&nbsp;two&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;remote&nbsp;machines&nbsp;named&nbsp;berlin&nbsp;and&nbsp;munich.&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Get-DiskDrive&nbsp;-drive&nbsp;c:,&nbsp;e:&nbsp;-computer&nbsp;berlin,&nbsp;munich&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;capacity&nbsp;and&nbsp;free&nbsp;space&nbsp;in&nbsp;gigabytes&nbsp;of&nbsp;the&nbsp;C:&nbsp;and&nbsp;e:&nbsp;drive.&nbsp;It&nbsp;also&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;percent&nbsp;free,&nbsp;and&nbsp;the&nbsp;drive&nbsp;letter&nbsp;and&nbsp;drive&nbsp;label&nbsp;of&nbsp;the&nbsp;system&nbsp;drive&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;two&nbsp;remote&nbsp;machines&nbsp;named&nbsp;berlin&nbsp;and&nbsp;munich.&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;c:&quot;,&quot;d:&quot;,&quot;f:&quot;&nbsp;|&nbsp;%&nbsp;{&nbsp;Get-DiskDrive&nbsp;$_&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;information&nbsp;about&nbsp;c,&nbsp;d,&nbsp;and&nbsp;f&nbsp;drives&nbsp;on&nbsp;local&nbsp;computer.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;.Example&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Get-DiskDrive&nbsp;-d&nbsp;&quot;c:&quot;,&quot;d:&quot;,&quot;f:&quot;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Returns&nbsp;information&nbsp;about&nbsp;c,&nbsp;d,&nbsp;and&nbsp;f&nbsp;drives&nbsp;on&nbsp;local&nbsp;computer.&nbsp;Same&nbsp;command&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;the&nbsp;previous&nbsp;example&nbsp;-&nbsp;but&nbsp;easier&nbsp;to&nbsp;read.&nbsp;But&nbsp;on&nbsp;my&nbsp;computer&nbsp;this&nbsp;is&nbsp;a&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;bit&nbsp;slower&nbsp;than&nbsp;the&nbsp;previous&nbsp;command&nbsp;(40&nbsp;milliseconds).&nbsp;
&nbsp;&nbsp;&nbsp;.Parameter&nbsp;drive&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;drive&nbsp;letter&nbsp;to&nbsp;query.&nbsp;&nbsp;Defaults&nbsp;to&nbsp;system&nbsp;drive&nbsp;(normally&nbsp;c:)&nbsp;
&nbsp;&nbsp;&nbsp;.Parameter&nbsp;computername&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;computer&nbsp;to&nbsp;query.&nbsp;Defaults&nbsp;to&nbsp;local&nbsp;machine.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;.Notes&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;NAME:&nbsp;&nbsp;Example-&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;AUTHOR:&nbsp;ed&nbsp;wilson,&nbsp;msft&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;LASTEDIT:&nbsp;06/02/2011&nbsp;16:12:08&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;KEYWORDS:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;HSG:&nbsp;HSG-06-26-2011&nbsp;
&nbsp;&nbsp;&nbsp;.Link&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Http://www.ScriptingGuys.com/blog&nbsp;
&nbsp;#Requires&nbsp;-Version&nbsp;2.0&nbsp;
&nbsp;#&gt;</span>&nbsp;
&nbsp;<span class="powerShell__keyword">Param</span>(&nbsp;
&nbsp;&nbsp;[string[]]<span class="powerShell__variable">$drive</span>&nbsp;=&nbsp;<span class="powerShell__variable">$env</span>:SystemDrive,&nbsp;
&nbsp;&nbsp;[string[]]<span class="powerShell__variable">$computername</span>&nbsp;=&nbsp;<span class="powerShell__variable">$env</span>:COMPUTERNAME&nbsp;
&nbsp;)&nbsp;<span class="powerShell__com">#end&nbsp;param</span>&nbsp;
&nbsp;<span class="powerShell__keyword">Foreach</span>(<span class="powerShell__variable">$d</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$drive</span>)&nbsp;
&nbsp;{&nbsp;
&nbsp;&nbsp;<span class="powerShell__cmdlets">Get-WmiObject</span>&nbsp;<span class="powerShell__operator">-</span>Class&nbsp;win32_Volume&nbsp;<span class="powerShell__operator">-</span>ComputerName&nbsp;<span class="powerShell__variable">$computername</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__keyword">Filter</span>&nbsp;<span class="powerShell__string">&quot;DriveLetter&nbsp;=&nbsp;'$d'&quot;</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;
&nbsp;&nbsp;<span class="powerShell__cmdlets">Select-object</span>&nbsp;DriveLetter,&nbsp;Label,&nbsp;FileSystem,&nbsp;PageFilePresent,&nbsp;&nbsp;
&nbsp;&nbsp;@{Name&nbsp;=&nbsp;<span class="powerShell__string">&quot;ComputerName&quot;</span>;&nbsp;Expression&nbsp;=&nbsp;{<span class="powerShell__variable">$_</span>.__Server}&nbsp;},&nbsp;
&nbsp;&nbsp;@{Name&nbsp;=&nbsp;<span class="powerShell__string">&quot;Capacity(GB)&quot;</span>;&nbsp;Expression&nbsp;=&nbsp;{<span class="powerShell__variable">$_</span>.capacity&nbsp;<span class="powerShell__operator">/</span>&nbsp;1GB}&nbsp;},&nbsp;&nbsp;
&nbsp;&nbsp;@{Name&nbsp;=&nbsp;<span class="powerShell__string">&quot;FreeSpace(GB)&quot;</span>;&nbsp;Expression&nbsp;=&nbsp;{<span class="powerShell__variable">$_</span>.Freespace&nbsp;<span class="powerShell__operator">/</span>&nbsp;1GB}&nbsp;},&nbsp;
&nbsp;&nbsp;@{Name&nbsp;=&nbsp;<span class="powerShell__string">&quot;PercentFree&quot;</span>;&nbsp;Expression&nbsp;=&nbsp;{&nbsp;(<span class="powerShell__variable">$_</span>.FreeSpace&nbsp;<span class="powerShell__operator">/</span>&nbsp;<span class="powerShell__variable">$_</span>.Capacity)<span class="powerShell__operator">*</span>100&nbsp;}&nbsp;}&nbsp;
&nbsp;}&nbsp;<span class="powerShell__com">#&nbsp;end&nbsp;foreach</span>&nbsp;
&nbsp;&nbsp;
}&nbsp;<span class="powerShell__com">#end&nbsp;function&nbsp;get-diskdrive</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<p>&nbsp;</p>

        </div>
    </body>
</html>